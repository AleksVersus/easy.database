# Easy.DataBase

Система управления базой данных — это комплексный модуль (библиотека), предназначенный для простого редактирования нереляционной базы данных на QSP.

Существует модуль Олегуса, реализующий то же самое, но через другие механизмы: https://forum.ifiction.ru/viewtopic.php?id=1522.

## Подключение

"easy.database" подключается как любой другой модуль QSP, то есть с использованием команды `inclib`. Скачайте архив со [страницы релизов](https://github.com/AleksVersus/easy.nrBD/releases), распакуйте и скопируйте папку "`lib`" в папку с вашей игрой. Тогда на самой первой локации в игре достаточно будет прописать такую команду подключения:

```qsp
inclib 'lib/easy.database.qsp'
```

Для работы модуля требуется так же подключить и библиотеку "easy.math". Она поставляется вместе с модулем. Подключение аналогичное:

```qsp
inclib 'lib/easy.math.qsp'
```

Если вы уже используете библиотеку "easy.math" в своей игре, убедитесь, что версия "easy.math" совместима с "easy.database". Для этого в любом месте вашей игры используйте команду:

```qsp
*pl @edb.start('em-version')
```

При запуске игры вы увидите на экране текущую и необходимую версии модуля "easy.math".

### Работа с исходниками

Если вы пишете игру, используя Sublime Text с подключённым пакетом QSP, у вас есть возможность самостоятельно собирать модуль из исходников.

В папке "`[source]`" размещены исходные тексты модуля, а так же файл "`project.json`", отредактировав который вы наладите сборку модуля в папку с вашей игрой.

Так же вы можете собирать игру, напрямую включая в неё все локации модуля, если это необходимо. В этом случае вам не потребуется подключать модуль к игре — он уже будет в неё встроен.

В исходниках предусмотрены два режима сборки: без обработки препроцессором и с обработкой препроцессором.

В первом случае модуль будет собран, как есть, включая все служебные комментарии и наборы "предохранителей" — сообщений, которые всплывают в виде модальных окон и предупреждают о некоторых наиболее распространённых ошибках при работе с модулем. Данный режим сборки необходим на этапе разработки, отладки и тестирования игры.

Во втором случае необходимо включить препроцессор в "`project.json`", тогда из собранного модуля будут удалены все служебные комментарии, а так же блоки "предохранителей". Данный режим рекомендуется использовать при сборке релизной версии игры, когда большая часть ошибок уже отловлена.

Вы также можете включить препроцессор, но сохранить блоки предохранителей в конечной сборке модуля. Для этого в исходном файле "`00_edb.start.qsps`" в любом месте пропишите строку:

```qsp
!@pp:var(fuse)
```

**Обратите внимание!** Исходники библиотеки "easy.math" необходимо скачивать отдельно: [easy.math на github](https://github.com/AleksVersus/easy.math.3)

### Подключение встроенного отладчика

Вы можете подключить отладочные команды модуля к командной строке (полю ввода), прописав в самом начале игры следующую команду:

```qsp
$usercom[] = 'edb.usercom'
```

Это добавит новый обработчик строки ввода к уже работающим. Обратите внимание на квадратные скобки. Если вы используете свой собственный обработчик строки ввода и хотите, чтобы обработчик модуля работал совместно (параллельно) с вашим, обязательно ставьте квадратные скобки после `$usercom`.

Все команды модуля должны начинаться с ключевого слова `edb`. Для вывода списка всех доступных команд, введите в строке ввода `edb.help`.

Так же список всех доступных команд для поля ввода представлен в разделе данной документации "Команды отладки".
